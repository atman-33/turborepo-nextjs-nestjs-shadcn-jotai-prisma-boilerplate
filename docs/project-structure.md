# プロジェクト構造

## web (Nest.js)

概ねのコードは `src` フォルダにあり、以下のような構成です。

```sh
src
|
+-- assets            # 画像、フォントなどの静的ファイルが含まれるassetsフォルダ
|
+-- components        # アプリケーション全体で共有されるコンポーネント
|
+-- config            # グローバルな設定、環境変数などがここからエクスポートされ、アプリで使用されます
|
+-- features          # 機能ベースのモジュール
|
+-- hooks             # アプリケーション全体で共有されるフック
|
+-- lib               # アプリケーションに事前に構成された異なるライブラリを再エクスポートします
|
+-- providers         # アプリケーションのすべてのプロバイダ
|
+-- routes            # ルートの設定（Nextjsプロジェクトでは利用しない）
|
+-- stores            # グローバルな状態ストア
|
+-- test              # テストユーティリティとモックサーバ
|
+-- types             # アプリケーション全体で使用される基本タイプ
|
+-- utils             # 共有のユーティリティ関数
```

アプリケーションを最も拡張可能で保守しやすい方法でスケーリングするには、`features` フォルダの中にほとんどのコードを保持し、異なる機能ベースのものが含まれるようにします。各 `feature` フォルダには、特定の機能に関連するドメイン固有のコードが含まれるべきです。これにより、機能をスコープ化し、その宣言を共有することなく機能を保持することができます。これは、多くのファイルを持つフラットなフォルダ構造よりもメンテナンスが容易です。  

機能は次のような構造を持つことができます。

```sh
src/features/awesome-feature
|
+-- api         # 特定の機能に関連するエクスポートされたAPIリクエスト宣言およびAPIフック
|
+-- assets      # 特定の機能に関連する静的ファイルが含まれるassetsフォルダ
|
+-- components  # 特定の機能にスコープが限定されたコンポーネント
|
+-- hooks       # 特定の機能にスコープが限定されたフック
|
+-- routes      # 特定の機能ページ用のルートコンポーネント（Nextjsプロジェクトでは利用しない）
|
+-- stores      # 特定の機能の状態ストア
|
+-- types       # TS特有の機能ドメイン用のTypeScriptタイプ
|
+-- utils       # 特定の機能用のユーティリティ関数
|
+-- index.ts    # 機能のエントリーポイントであり、与えられた機能の公開APIとして機能し、外部で使用されるすべてをエクスポートする必要があります
```

機能からのすべてのものは `index.ts` ファイルからエクスポートされるべきであり、これは機能の公開APIとして振る舞います。

他の機能からのインポートは次のように行います。

`import {AwesomeComponent} from "@/features/awesome-feature"`

そして、

`import {AwesomeComponent} from "@/features/awesome-feature/components/AwesomeComponent`

のようなインポートは行わないでください。

これは、ESLint設定で以下のルールを使って後者のインポートを許可しないようにすることもできます。


```js
{
    rules: {
        "no-restricted-imports": [
          "error",
          {
            "patterns": [
              "@/features/*/*"
            ]
          }
        ]
    // ...設定の残りの部分
}
```

これは、[Nx](https://nx.dev/) が他のモジュールから使用可能ながらも隔離されたライブラリをどのように扱うかに触発されました。機能を、自己完結型のライブラリまたはモジュールと考え、そのエントリーポイントを介して他の機能に異なる部分を公開できるものとして考えてください。